<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pra onde vou</title>
    <script
            src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"></script>
    <script>

        const LENGTH_ZIP_CODE = 8;

        const getAddress = () => {

            let zipCode = document.getElementById("zipCode").value;
            zipCode = String(zipCode).replace(/[^0-9]/g,'');
            document.getElementById("zipCode").value = zipCode;

            if(String(zipCode).length === LENGTH_ZIP_CODE){
                fetch(`http://viacep.com.br/ws/${zipCode}/json/`).then((body) => body.json())
                    .then((data) => {
                        if (data.erro){
                            return;
                        }else{
                            document.getElementById("bairro").value = data.bairro;
                            document.getElementById("estado").value = data.localidade;
                            document.getElementById("nomeLocalidade").value = data.logradouro;
                        }
                    });
            }
        }

        const formIsValid = () => {
            fieldsIsNotEmpty() ? $("#submitForm").prop('disabled', false) : $("#submitForm").prop('disabled', true);
        }

        const fieldsIsNotEmpty = () => document.getElementById("bairro").value !== "" &&
            document.getElementById("estado").value !== "" &&
            document.getElementById("nomeLocalidade").value !== "" &&
            document.getElementById("zipCode").value !== "" &&
            document.getElementById("numero").value !== "";
    </script>
</head>

<body>

    <form action="/pontos" method="post">

        <input placeholder="CEP" maxlength="10" onblur="formIsValid()" onkeyup="getAddress()" id="zipCode" type="text">
        <input placeholder="NÃºmero" onblur="formIsValid()" id="numero" type="text">
        <input placeholder="Bairro" onblur="formIsValid()" id="bairro" type="text">
        <input placeholder="Estado" onblur="formIsValid()" id="estado" type="text">
        <input placeholder="Nome da localidade" onblur="formIsValid()" id="nomeLocalidade" type="text">

        <button disabled id="submitForm" type="submit">Cadastrar</button>
    </form>
</body>
</html>